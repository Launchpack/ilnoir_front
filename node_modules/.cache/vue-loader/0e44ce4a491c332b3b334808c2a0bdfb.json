{"remainingRequest":"/Users/mard/dev/ilnoir/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mard/dev/ilnoir/src/components/PagePc/InsuranceRequest.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mard/dev/ilnoir/src/components/PagePc/InsuranceRequest.vue","mtime":1607321927123},{"path":"/Users/mard/dev/ilnoir/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mard/dev/ilnoir/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/mard/dev/ilnoir/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mard/dev/ilnoir/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport CInputFileUploader from \"@/components/Components/Form/CInputFileUploader\";\n\nexport default {\n  name: \"InsuranceRequest\",\n  components: {\n    CInputFileUploader\n  },\n  data() {\n    return {\n      detail: {\n      },\n      checkState: false,\n      agreeState: false,\n      dropState: false,\n      commonInvalid: false,\n      acciInvalid: false,\n      privacyInvalid: false,\n      agreeStyle: {\n        fontSize: '18px',\n        color: 'white',\n        backgroundColor: '#4f76ff',\n        border: '1px solid #4f76ff'\n      },\n      disStyle: {\n        fontSize: '18px',\n        color: 'white',\n        backgroundColor: 'white',\n        border: '1px solid #dddddd'\n      },\n      params: {\n        order_id: '',\n        identification: [],\n        bank_book: [],\n        invoice: [],\n        delivery: [],\n        seller: [],\n        damage: [],\n        misdelivery: [],\n        theft: [],\n        lost: [],\n        return: [],\n        privacy: [],\n        send_back: [],\n        accident: []\n      },\n      commonList: ['privacy', 'identification', 'bank_book', 'invoice', 'delivery', 'seller'],\n      acciList: ['damage', 'misdelivery', 'theft', 'lost', 'return'],\n      selectedAcci: undefined\n    }\n  },\n  created() {\n    this.getData();\n  },\n  methods: {\n    getData() {\n      this.$axios.get(`http://54.180.114.33/api/user/${this.$route.query.user}/order/${this.$route.query.id}`).then(res => {\n        if(res.status===200) {\n          this.detail = res.data;\n        }\n      });\n    },\n    acciState(val) {\n      if(this.selectedAcci===undefined) {\n        return true;\n      }\n      else {\n        if(this.selectedAcci===val) {\n          return true;\n        }\n        else {\n          return false;\n        }\n      }\n    },\n    computedDate() {\n      if(this.detail.invoice_date.length>0) {\n        return this.detail.invoice_date.split('T')[0];\n      }\n      else {\n        return ''\n      }\n    },\n    onFileChange(e, val) {\n      let file = e.target.files;\n      this.params[val].push(file);\n      if(this.acciList.indexOf(val)>-1) {\n        this.selectedAcci = val;\n      }\n      console.log(file)\n      // let reader = new FileReader();\n      // reader.readAsDataURL(file);\n      // reader.onload = (f) => {\n      //   let ext = file.name.split('.')[file.name.split('.').length-1];\n      //   this.params[val].push({\n      //     name: file.name,\n      //     file : f.srcElement.result,\n      //     size: file.size,\n      //     extention: ext\n      //   })\n      // }\n    },\n    clickDelete(val) {\n      this.params[val] = [];\n      if(this.acciList.indexOf(val)>-1) {\n        this.selectedAcci = undefined;\n      }\n    },\n    clickBtn() {\n      this.routerPush('insurance_search');\n    },\n    clickAgree() {\n      this.agreeState = !this.agreeState;\n    },\n    clickDrop() {\n      this.dropState = !this.dropState;\n    },\n    async clickRequest() {\n      let accident = [];\n      let params = Object.entries(this.params);\n      let param = {};\n      if(this.agreeState === false) {\n        this.privacyInvalid = true;\n      }\n      else {\n        await params.forEach(item => {\n          if(item[1].length===0) {\n            if(this.commonList.indexOf(item[0])>-1) {\n              this.commonInvalid = true;\n            }\n            else if(this.acciList.indexOf(item[0])>-1) {\n              accident.push(false);\n            }\n          }\n          else {\n            if(this.acciList.indexOf(item[0])>-1) {\n              accident.push(true);\n              param['accident'] = item[1][0];\n            }\n            else {\n              param[item[0]] = item[1][0];\n            }\n          }\n        });\n      }\n\n      if(accident.indexOf(true)===-1) {\n        this.acciInvalid = true;\n      }\n      \n      if(this.commonInvalid | this.acciInvalid | this.privacyInvalid) return;\n\n      let formData = new FormData();\n      let headers = { 'Content-Type': 'multipart/form-data' }\n      // param.order_id = this.detail._id;\n      console.log(param)\n      formData.append('order_id', this.detail._id);\n      this.addFormData(formData, param);\n      \n      // params.order_id = this.detail._id;\n      this.$axios.post(`http://54.180.114.33/api/user/claim`, formData, headers).then(res => {\n        console.log('res',res)\n        if(res.status===200) {\n          this.routerPush('request_done')\n        }\n      });\n\n      console.log('done')\n    },\n    addFormData (formData, param) {\n      for (let [key, value] of Object.entries(param)) {\n          for (let item of value) {\n\n              formData.append(key, item);\n              console.log(key, value, item)\n              console.log('formData',formData)\n          }\n      }\n      // for (let file of this.value[]) {\n      //     formData.append(`file${i}`, file) // note, no square-brackets\n      // }\n    },\n    clickModal() {\n      this.commonInvalid = false;\n      this.acciInvalid = false;\n      this.privacyInvalid = false;\n    },\n    clickDown(val) {\n      if(val==='privacy') {\n        // let filename = \"https://launchpack-storage.s3.ap-northeast-2.amazonaws.com/media/grit12/non-path/12371331_thumb.png\";\n        // var filename = url.substring(url.lastIndexOf(\"/\") + 1).split(\"?\")[0];\n        // var xhr = new XMLHttpRequest();\n        // xhr.responseType = 'blob';\n        // xhr.onload = function () {\n        //     var a = document.createElement('a');\n        //     a.href = window.URL.createObjectURL(xhr.response); \n        //     a.download = filename; \n        //     a.style.display = 'none';\n        //     document.body.appendChild(a);\n        //     a.click();\n        //     delete a;\n        // };\n        // xhr.open('GET', filename);\n        // xhr.send();\n        console.log('privacy down')\n      }\n      else if(val==='theft') {\n        console.log('theft')\n      }\n      else if(val='lost') {\n        console.log('lost')\n      }\n      else {\n        console.log('else')\n      }\n    }\n  },\n  computed: {\n    modalStyle() {\n      return {\n        width: `${window.innerWidth}px`,\n        height: `${window.innerHeight}px`,\n        top: 0,\n        left: 0,\n        backgroundColor: 'rgba(0,0,0,0.5)',\n        zIndex: '9999'\n      }\n    }\n  }\n}\n",{"version":3,"sources":["InsuranceRequest.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiWA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"InsuranceRequest.vue","sourceRoot":"src/components/PagePc","sourcesContent":["<template>\n<div style=\"color:#212121;background-color:#f8f8f8\" class=\"flex-justify\"\n  v-if=\"detail\">\n  <div :style=\"pcMaxWidth\">\n    <div class=\"size-26 weight-500\" style=\"padding:60px 0 12px\">보험금 청구</div>\n    <div class=\"flex-end size-14\">\n      <div class=\"weight-400\">{{ detail.user.name }} ({{ detail.user.phone }})</div>\n      <div class=\"btn-back text-center weight-400 unselect\" @click=\"clickBtn\"\n        style=\"margin-left:12px\">다른 이름으로 조회</div>\n    </div>\n\n    <div style=\"margin-bottom:40px\">\n      <div class=\"size-18 margin-bottom-16 weight-500\" style=\"color:#4f76ff\">가입 내용</div>\n      <div class=\"table-title flex-align size-15 text-center\">\n        <div class=\"col-4\">보험상품명</div>\n        <div class=\"col-2\">피보험자명</div>\n        <div class=\"col-2\">보험증권번호</div>\n        <div class=\"col-2\">보험개시일</div>\n        <div class=\"col-2\">보험가입금액</div>\n      </div>\n\n      <div class=\"table-content flex-align size-15 text-center\">\n        <div class=\"col-4\">{{ detail.insurance.name }}</div>\n        <div class=\"col-2\">{{ detail.user.name }}</div>\n        <div class=\"col-2\">{{ detail.stock_number }}</div>\n        <div class=\"col-2\">{{ computedDate() }}</div>\n        <div class=\"col-2\">{{ detail.insurance_price | currency }}</div>\n      </div>\n    </div>\n\n    <div style=\"margin-bottom:40px\">\n      <div class=\"size-18 margin-bottom-16 weight-500\" style=\"color:#4f76ff\">공통 구비서류</div>\n      <div class=\"size-15\" style=\"border-top:2px solid #696969\">\n        <div class=\"table-contents flex-between\">\n          <div class=\"flex-align\">\n            <i class=\"material-icons\" style=\"margin-right:8px;font-size:20px\"\n              :style=\"params['privacy'].length>0 ? {color:'#4f76ff'} : {color:'#dddddd'} \">check</i>\n            <div class=\"size-15 weight-400\">보험금청구서/개인정보처리동의서</div>\n          </div>\n\n            <div v-if=\"params['privacy'].length>0\" class=\"flex-align size-13\"\n              style=\"color:#696969\">\n              <div>{{ params['privacy'][0][0].name }}</div>\n              <div class=\"btn-delete unselect weight-400\" style=\"margin-left:12px\"\n                @click=\"clickDelete('privacy')\">삭제</div>\n            </div>\n            <div v-else class=\"size-13 flex-align\">\n              <a class=\"btn-download unselect weight-400\"\n                href=\"static/image/icon/ic_apple.png\" download\n                @click=\"clickDown('privacy')\">양식 다운로드</a>\n              <input type=\"file\" id=\"privacy\" class=\"input-hidden\"\n                @change=\"e => onFileChange(e,'privacy')\">\n              <label class=\"btn-upload unselect weight-400\" style=\"margin-left:12px\"\n                for=\"privacy\">파일첨부</label>\n            </div>\n        </div>\n\n        <div class=\"table-contents flex-between\">\n          <div class=\"flex-align\">\n            <i class=\"material-icons\" style=\"margin-right:8px;font-size:20px\"\n              :style=\"params['identification'].length>0 ? {color:'#4f76ff'} : {color:'#dddddd'} \">check</i>\n            <div class=\"size-15 weight-400\" style=\"margin-right:20px\">신분증 사본</div>\n            <div class=\"size-14 weight-400\" style=\"color:#9e9e9e\">사업자인 경우 사업자등록증 사본</div>\n          </div>\n\n            <div v-if=\"params['identification'].length>0\" class=\"flex-align size-13\"\n              style=\"color:#696969\">\n              <div>{{ params['identification'][0][0].name }}</div>\n              <div class=\"btn-delete unselect weight-400\" style=\"margin-left:12px\"\n                @click=\"clickDelete('identification')\">삭제</div>\n            </div>\n            <div v-else class=\"size-13 flex-align\">\n              <input type=\"file\" id=\"identification\" class=\"input-hidden\"\n                @change=\"e => onFileChange(e,'identification')\">\n              <label class=\"btn-upload unselect weight-400\" style=\"margin-left:12px\"\n                for=\"identification\">파일첨부</label>\n            </div>\n        </div>\n\n        <div class=\"table-contents flex-between\">\n          <div class=\"flex-align\">\n            <i class=\"material-icons\" style=\"margin-right:8px;font-size:20px\"\n              :style=\"params['bank_book'].length>0 ? {color:'#4f76ff'} : {color:'#dddddd'} \">check</i>\n            <div class=\"size-15 weight-400\">통장사본</div>\n          </div>\n\n            <div v-if=\"params['bank_book'].length>0\" class=\"flex-align size-13\"\n              style=\"color:#696969\">\n              <div>{{ params['bank_book'][0][0].name }}</div>\n              <div class=\"btn-delete unselect weight-400\" style=\"margin-left:12px\"\n                @click=\"clickDelete('bank_book')\">삭제</div>\n            </div>\n            <div v-else class=\"size-13 flex-align\">\n              <input type=\"file\" id=\"bank_book\" class=\"input-hidden\"\n                @change=\"e => onFileChange(e,'bank_book')\">\n              <label class=\"btn-upload unselect weight-400\" style=\"margin-left:12px\"\n                for=\"bank_book\">파일첨부</label>\n            </div>\n        </div>\n\n        <div class=\"table-contents flex-between\">\n          <div class=\"flex-align\">\n            <i class=\"material-icons\" style=\"margin-right:8px;font-size:20px\"\n              :style=\"params['invoice'].length>0 ? {color:'#4f76ff'} : {color:'#dddddd'} \">check</i>\n            <div class=\"size-15 weight-400\">운송장</div>\n          </div>\n\n            <div v-if=\"params['invoice'].length>0\" class=\"flex-align size-13\"\n              style=\"color:#696969\">\n              <div>{{ params['invoice'][0][0].name }}</div>\n              <div class=\"btn-delete unselect weight-400\" style=\"margin-left:12px\"\n                @click=\"clickDelete('invoice')\">삭제</div>\n            </div>\n            <div v-else class=\"size-13 flex-align\">\n              <input type=\"file\" id=\"invoice\" class=\"input-hidden\"\n                @change=\"e => onFileChange(e,'invoice')\">\n              <label class=\"btn-upload unselect weight-400\" style=\"margin-left:12px\"\n                for=\"invoice\">파일첨부</label>\n            </div>\n        </div>\n\n        <div class=\"table-contents flex-between\">\n          <div class=\"flex-align\">\n            <i class=\"material-icons\" style=\"margin-right:8px;font-size:20px\"\n              :style=\"params['delivery'].length>0 ? {color:'#4f76ff'} : {color:'#dddddd'} \">check</i>\n            <div class=\"size-15 weight-400\">택배시 배송이력화면 캡쳐</div>\n          </div>\n\n            <div v-if=\"params['delivery'].length>0\" class=\"flex-align size-13\"\n              style=\"color:#696969\">\n              <div>{{ params['delivery'][0][0].name }}</div>\n              <div class=\"btn-delete unselect weight-400\" style=\"margin-left:12px\"\n                @click=\"clickDelete('delivery')\">삭제</div>\n            </div>\n            <div v-else class=\"size-13 flex-align\">\n              <input type=\"file\" id=\"delivery\" class=\"input-hidden\"\n                @change=\"e => onFileChange(e,'delivery')\">\n              <label class=\"btn-upload unselect weight-400\" style=\"margin-left:12px\"\n                for=\"delivery\">파일첨부</label>\n            </div>\n        </div>\n\n        <div class=\"table-contents flex-between\">\n          <div class=\"flex-align\">\n            <i class=\"material-icons\" style=\"margin-right:8px;font-size:20px\"\n              :style=\"params['seller'].length>0 ? {color:'#4f76ff'} : {color:'#dddddd'} \">check</i>\n            <div class=\"size-15 weight-400\">구매 당시 판매자가 등재한 물품사진</div>\n          </div>\n\n            <div v-if=\"params['seller'].length>0\" class=\"flex-align size-13\"\n              style=\"color:#696969\">\n              <div>{{ params['seller'][0][0].name }}</div>\n              <div class=\"btn-delete unselect weight-400\" style=\"margin-left:12px\"\n                @click=\"clickDelete('seller')\">삭제</div>\n            </div>\n            <div v-else class=\"size-13 flex-align\">\n              <input type=\"file\" id=\"seller\" class=\"input-hidden\"\n                @change=\"e => onFileChange(e,'seller')\">\n              <label class=\"btn-upload unselect weight-400\" style=\"margin-left:12px\"\n                for=\"seller\">파일첨부</label>\n            </div>\n        </div>\n\n      </div>\n    </div>\n\n    <div style=\"margin-bottom:40px\">\n      <div class=\"flex-align margin-bottom-16\">\n        <div class=\"size-18 weight-500\" style=\"color:#4f76ff;margin-right:20px\">사고 유형별 구비서류</div>\n        <div class=\"size-14 weight-500\" style=\"color:#696969\">아래 사고 유형 중 한가지를 선택하여 입력해 주세요.</div>\n       </div> \n      <div class=\"size-15\" style=\"border-top:2px solid #696969\">\n        <div class=\"table-contents flex-between\">\n          <div class=\"flex-align\">\n            <div class=\"size-15 weight-400\">1. 파손시</div>\n          </div>\n\n            <div v-if=\"params['damage'].length>0\" class=\"flex-align size-13\"\n              style=\"color:#696969\">\n              <div>{{ params['damage'][0][0].name }}</div>\n              <div class=\"btn-delete unselect weight-400\" style=\"margin-left:12px\"\n                @click=\"clickDelete('damage')\">삭제</div>\n            </div>\n            <div v-else class=\"size-13 flex-align\">\n              <input type=\"file\" id=\"damage\" class=\"input-hidden\"\n                @change=\"e => onFileChange(e,'damage')\">\n              <label class=\"btn-upload unselect weight-400\" style=\"margin-left:12px\"\n                for=\"damage\"\n                v-if=\"acciState('damage')\">파일첨부</label>\n              <div v-else style=\"width:0;height:38px\"></div>\n            </div>\n        </div>\n\n        <div class=\"table-contents flex-between\">\n          <div class=\"flex-align\">\n            <div class=\"size-15 weight-400\" style=\"margin-right:16px\">2. 망실(오배송)</div>\n            <div class=\"size-14 weight-400\" style=\"color:#bbbbbb\">경찰서사고접수확인서 등 판매자 사기신고서류 첨부</div>\n          </div>\n\n            <div v-if=\"params['misdelivery'].length>0\" class=\"flex-align size-13\"\n              style=\"color:#696969\">\n              <div>{{ params['misdelivery'][0][0].name }}</div>\n              <div class=\"btn-delete unselect weight-400\" style=\"margin-left:12px\"\n                @click=\"clickDelete('misdelivery')\">삭제</div>\n            </div>\n            <div v-else class=\"size-13 flex-align\">\n              <input type=\"file\" id=\"misdelivery\" class=\"input-hidden\"\n                @change=\"e => onFileChange(e,'misdelivery')\">\n              <label class=\"btn-upload unselect weight-400\" style=\"margin-left:12px\"\n                for=\"misdelivery\"\n                v-if=\"acciState('misdelivery')\">파일첨부</label>\n              <div v-else style=\"width:0;height:38px\"></div>\n            </div>\n        </div>\n\n        <div class=\"table-contents flex-between\">\n          <div class=\"flex-align\">\n            <div class=\"size-15 weight-400\" style=\"margin-right:16px\">3. 배송이 완료되었으나 물품 도난시</div>\n            <div class=\"size-14 weight-400\" style=\"color:#bbbbbb\">운송인(택배기사 등)이 작성한 도난확인증명서 첨부</div>\n          </div>\n\n            <div v-if=\"params['theft'].length>0\" class=\"flex-align size-13\"\n              style=\"color:#696969\">\n              <div>{{ params['theft'][0][0].name }}</div>\n              <div class=\"btn-delete unselect weight-400\" style=\"margin-left:12px\"\n                @click=\"clickDelete('theft')\">삭제</div>\n            </div>\n            <div v-else class=\"size-13 flex-align\">\n              <a class=\"btn-download unselect weight-400\"\n                v-if=\"acciState('theft')\"\n                href=\"static/image/icon/ic_apple.png\" download\n                @click=\"clickDown('theft')\">양식 다운로드</a>\n              <input type=\"file\" id=\"theft\" class=\"input-hidden\"\n                @change=\"e => onFileChange(e,'theft')\">\n              <label class=\"btn-upload unselect weight-400\" style=\"margin-left:12px\"\n                for=\"theft\"\n                v-if=\"acciState('theft')\">파일첨부</label>\n              <div v-else style=\"width:0;height:38px\"></div>\n            </div>\n        </div>\n\n        <div class=\"table-contents flex-between\">\n          <div class=\"flex-align\">\n            <div class=\"size-15 weight-400\" style=\"margin-right:16px\">4. 분실</div>\n            <div class=\"size-14 weight-400\" style=\"color:#bbbbbb\">운송인(택배기사 등)이 작성한 분실확인증명서 첨부</div>\n          </div>\n\n            <div v-if=\"params['lost'].length>0\" class=\"flex-align size-13\"\n              style=\"color:#696969\">\n              <div>{{ params['lost'][0][0].name }}</div>\n              <div class=\"btn-delete unselect weight-400\" style=\"margin-left:12px\"\n                @click=\"clickDelete('lost')\">삭제</div>\n            </div>\n            <div v-else class=\"size-13 flex-align\">\n              <a class=\"btn-download unselect weight-400\"\n                v-if=\"acciState('lost')\"\n                href=\"static/image/icon/ic_apple.png\" download\n                @click=\"clickDown('lost')\">양식 다운로드</a>\n              <input type=\"file\" id=\"lost\" class=\"input-hidden\"\n                @change=\"e => onFileChange(e,'lost')\">\n              <label class=\"btn-upload unselect weight-400\" style=\"margin-left:12px\"\n                for=\"lost\"\n                v-if=\"acciState('lost')\">파일첨부</label>\n              <div v-else style=\"width:0;height:38px\"></div>\n            </div>\n        </div>\n\n        <div class=\"table-contents flex-between\">\n          <div class=\"flex-align\">\n            <div class=\"size-15 weight-400\" style=\"margin-right:16px\">5. 반송시</div>\n            <div class=\"size-14 weight-400\" style=\"color:#bbbbbb\">반품운송장과 반품배송비용 영수증 첨부</div>\n          </div>\n\n            <div v-if=\"params['return'].length>0\" class=\"flex-align size-13\"\n              style=\"color:#696969\">\n              <div>{{ params['return'][0][0].name }}</div>\n              <div class=\"btn-delete unselect weight-400\" style=\"margin-left:12px\"\n                @click=\"clickDelete('return')\">삭제</div>\n            </div>\n            <div v-else class=\"size-13 flex-align\">\n              <input type=\"file\" id=\"return\" class=\"input-hidden\"\n                @change=\"e => onFileChange(e,'return')\">\n              <label class=\"btn-upload unselect weight-400\" style=\"margin-left:12px\"\n                for=\"return\"\n                v-if=\"acciState('return')\">파일첨부</label>\n              <div v-else style=\"width:0;height:38px\"></div>\n            </div>\n        </div>\n\n      </div>\n    </div>\n\n    <div style=\"margin-bottom:60px\">\n      <div class=\"flex-align margin-bottom-16\">\n        <div class=\"size-18 weight-500\" style=\"color:#4f76ff;margin-right:20px\">개인 정보 제공 동의</div>\n       </div> \n      <div class=\"size-15\" style=\"border-top:2px solid #696969\">\n        <div class=\"table-privacy flex-between\">\n          <div class=\"flex-align unselect\" @click=\"clickAgree\">\n            <i class=\"material-icons\" :style=\"agreeState ? agreeStyle : disStyle\"\n              style=\"margin-right:8px\">check</i>\n            <div class=\"size-15\">정보 제공 동의 확인</div>\n          </div>\n        </div>\n\n        <div class=\"table-privacy flex-between\">\n          <div class=\"flex-align unselect\" @click=\"clickDrop\">\n            <i class=\"material-icons\" \n              style=\"margin-right:6px;color:#4f76ff;font-size:16px\">{{ dropState ? 'remove' : 'add'}}</i>\n            <div class=\"size-15 weight-400\" style=\"margin-right:16px\">개인 정보 수집·이용에 관한 동의사항</div>\n          </div>\n        </div>\n        <div v-if=\"dropState\" class=\"drop-box size-14\">\n          개인정보 처리방침\n        </div>\n\n      </div>\n    </div>\n\n    <div class=\"flex-justify\">\n      <div class=\"btn-request size-16 weight-400 unselect\"\n        @click=\"clickRequest\">제출하기</div>\n    </div>\n\n  </div>\n\n  <div class=\"position-fixed flex-center\" :style=\"modalStyle\" v-if=\"commonInvalid\">\n    <div class=\"text-center\">\n      <div class=\"modal-white size-14\">공통 구비서류를 모두 첨부해 주시기 바랍니다.</div>\n      <div class=\"modal-btn size-16 unselect\"\n        @click.stop.prevent=\"clickModal\">확인</div>\n    </div>\n  </div>\n\n  <div class=\"position-fixed flex-center\" :style=\"modalStyle\" v-if=\"acciInvalid\">\n    <div class=\"text-center\">\n      <div class=\"modal-white size-14\">사고유형별 구비서류를 첨부해 주시기 바랍니다.</div>\n      <div class=\"modal-btn size-16 unselect\"\n        @click.stop.prevent=\"clickModal\">확인</div>\n    </div>\n  </div>\n\n  <div class=\"position-fixed flex-center\" :style=\"modalStyle\" v-if=\"privacyInvalid\">\n    <div class=\"text-center\">\n      <div class=\"modal-white size-14\">개인 정보 제공에 동의해 주시기 바랍니다.</div>\n      <div class=\"modal-btn size-16 unselect\"\n        @click.stop.prevent=\"clickModal\">확인</div>\n    </div>\n  </div>\n\n</div>\n</template>\n<script>\nimport CInputFileUploader from \"@/components/Components/Form/CInputFileUploader\";\n\nexport default {\n  name: \"InsuranceRequest\",\n  components: {\n    CInputFileUploader\n  },\n  data() {\n    return {\n      detail: {\n      },\n      checkState: false,\n      agreeState: false,\n      dropState: false,\n      commonInvalid: false,\n      acciInvalid: false,\n      privacyInvalid: false,\n      agreeStyle: {\n        fontSize: '18px',\n        color: 'white',\n        backgroundColor: '#4f76ff',\n        border: '1px solid #4f76ff'\n      },\n      disStyle: {\n        fontSize: '18px',\n        color: 'white',\n        backgroundColor: 'white',\n        border: '1px solid #dddddd'\n      },\n      params: {\n        order_id: '',\n        identification: [],\n        bank_book: [],\n        invoice: [],\n        delivery: [],\n        seller: [],\n        damage: [],\n        misdelivery: [],\n        theft: [],\n        lost: [],\n        return: [],\n        privacy: [],\n        send_back: [],\n        accident: []\n      },\n      commonList: ['privacy', 'identification', 'bank_book', 'invoice', 'delivery', 'seller'],\n      acciList: ['damage', 'misdelivery', 'theft', 'lost', 'return'],\n      selectedAcci: undefined\n    }\n  },\n  created() {\n    this.getData();\n  },\n  methods: {\n    getData() {\n      this.$axios.get(`http://54.180.114.33/api/user/${this.$route.query.user}/order/${this.$route.query.id}`).then(res => {\n        if(res.status===200) {\n          this.detail = res.data;\n        }\n      });\n    },\n    acciState(val) {\n      if(this.selectedAcci===undefined) {\n        return true;\n      }\n      else {\n        if(this.selectedAcci===val) {\n          return true;\n        }\n        else {\n          return false;\n        }\n      }\n    },\n    computedDate() {\n      if(this.detail.invoice_date.length>0) {\n        return this.detail.invoice_date.split('T')[0];\n      }\n      else {\n        return ''\n      }\n    },\n    onFileChange(e, val) {\n      let file = e.target.files;\n      this.params[val].push(file);\n      if(this.acciList.indexOf(val)>-1) {\n        this.selectedAcci = val;\n      }\n      console.log(file)\n      // let reader = new FileReader();\n      // reader.readAsDataURL(file);\n      // reader.onload = (f) => {\n      //   let ext = file.name.split('.')[file.name.split('.').length-1];\n      //   this.params[val].push({\n      //     name: file.name,\n      //     file : f.srcElement.result,\n      //     size: file.size,\n      //     extention: ext\n      //   })\n      // }\n    },\n    clickDelete(val) {\n      this.params[val] = [];\n      if(this.acciList.indexOf(val)>-1) {\n        this.selectedAcci = undefined;\n      }\n    },\n    clickBtn() {\n      this.routerPush('insurance_search');\n    },\n    clickAgree() {\n      this.agreeState = !this.agreeState;\n    },\n    clickDrop() {\n      this.dropState = !this.dropState;\n    },\n    async clickRequest() {\n      let accident = [];\n      let params = Object.entries(this.params);\n      let param = {};\n      if(this.agreeState === false) {\n        this.privacyInvalid = true;\n      }\n      else {\n        await params.forEach(item => {\n          if(item[1].length===0) {\n            if(this.commonList.indexOf(item[0])>-1) {\n              this.commonInvalid = true;\n            }\n            else if(this.acciList.indexOf(item[0])>-1) {\n              accident.push(false);\n            }\n          }\n          else {\n            if(this.acciList.indexOf(item[0])>-1) {\n              accident.push(true);\n              param['accident'] = item[1][0];\n            }\n            else {\n              param[item[0]] = item[1][0];\n            }\n          }\n        });\n      }\n\n      if(accident.indexOf(true)===-1) {\n        this.acciInvalid = true;\n      }\n      \n      if(this.commonInvalid | this.acciInvalid | this.privacyInvalid) return;\n\n      let formData = new FormData();\n      let headers = { 'Content-Type': 'multipart/form-data' }\n      // param.order_id = this.detail._id;\n      console.log(param)\n      formData.append('order_id', this.detail._id);\n      this.addFormData(formData, param);\n      \n      // params.order_id = this.detail._id;\n      this.$axios.post(`http://54.180.114.33/api/user/claim`, formData, headers).then(res => {\n        console.log('res',res)\n        if(res.status===200) {\n          this.routerPush('request_done')\n        }\n      });\n\n      console.log('done')\n    },\n    addFormData (formData, param) {\n      for (let [key, value] of Object.entries(param)) {\n          for (let item of value) {\n\n              formData.append(key, item);\n              console.log(key, value, item)\n              console.log('formData',formData)\n          }\n      }\n      // for (let file of this.value[]) {\n      //     formData.append(`file${i}`, file) // note, no square-brackets\n      // }\n    },\n    clickModal() {\n      this.commonInvalid = false;\n      this.acciInvalid = false;\n      this.privacyInvalid = false;\n    },\n    clickDown(val) {\n      if(val==='privacy') {\n        // let filename = \"https://launchpack-storage.s3.ap-northeast-2.amazonaws.com/media/grit12/non-path/12371331_thumb.png\";\n        // var filename = url.substring(url.lastIndexOf(\"/\") + 1).split(\"?\")[0];\n        // var xhr = new XMLHttpRequest();\n        // xhr.responseType = 'blob';\n        // xhr.onload = function () {\n        //     var a = document.createElement('a');\n        //     a.href = window.URL.createObjectURL(xhr.response); \n        //     a.download = filename; \n        //     a.style.display = 'none';\n        //     document.body.appendChild(a);\n        //     a.click();\n        //     delete a;\n        // };\n        // xhr.open('GET', filename);\n        // xhr.send();\n        console.log('privacy down')\n      }\n      else if(val==='theft') {\n        console.log('theft')\n      }\n      else if(val='lost') {\n        console.log('lost')\n      }\n      else {\n        console.log('else')\n      }\n    }\n  },\n  computed: {\n    modalStyle() {\n      return {\n        width: `${window.innerWidth}px`,\n        height: `${window.innerHeight}px`,\n        top: 0,\n        left: 0,\n        backgroundColor: 'rgba(0,0,0,0.5)',\n        zIndex: '9999'\n      }\n    }\n  }\n}\n</script>\n<style scoped>\n.btn-back {\n  width: 136px;\n  height: 34px;\n  line-height: 32px;\n  background-color: #7e7e7e;\n  color: white;\n}\n.table-title {\n  background-color: white;\n  padding: 8px 0;\n  border-top: 2px solid #696969;\n  border-bottom: 2px solid #696969;\n}\n.table-content {\n  background-color: white;\n  padding: 12px 0;\n  border-bottom: 1px solid #eeeeee;\n}\n.table-contents {\n  background-color: white;\n  padding: 6px 12px;\n  border-bottom: 1px solid #eeeeee;\n}\n.table-privacy {\n  background-color: white;\n  padding: 12px 12px;\n  border-bottom: 1px solid #eeeeee;\n}\n.btn-delete {\n  border: 1px solid #dddddd;\n  padding: 8px 12px;\n}\n.btn-upload {\n  border: 1px solid #4f76ff;\n  color: #4f76ff;\n  padding: 8px 0;\n  width: 120px;\n  text-align: center;\n}\n.btn-download {\n  border: 1px solid #dddddd;\n  color: #696969;\n  padding: 8px 0;\n  width: 120px;\n  text-align: center;\n}\n.drop-box {\n  padding: 16px;\n  background-color: #eeeeee;\n  max-height: 420px;\n  overflow-y: auto;\n}\n.btn-request {\n  width: 360px;\n  height: 54px;\n  line-height: 54px;\n  text-align: center;\n  background-color: #4f76ff;\n  color: white;\n}\n.modal-white {\n  width: 400px;\n  height: 140px;\n  line-height: 140px;\n  background-color: white;\n}\n.modal-btn {\n  width: 400px;\n  height: 54px;\n  line-height: 54px;\n  background-color: #4f76ff;\n  color: white;\n}\n.input-hidden {\n  width: 0;\n  height: 0;\n  position: fixed;\n  top: -100px;\n  left: -100px;\n}\n</style>"]}]}